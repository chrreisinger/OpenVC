\chapter{VHDL}
{\em 
In diese Kapitel wird ein Überblick über die Sprache VHDL geben. Zuerst wird die Geschichte und die damit verbundenen Standards erläutert, anschließend die Sprache selbst.
Danach wird der Unterschied zwischen Simulation und Synthese besprochen und der Funktionsumfang des OpenVC.
}
\section{Geschichte}
VHDL (Very High Speed Integrated Circuit Hardware Description Language oder auch VHSIC Hardware Description Language) ist eine vom IEEE standardisierte Sprache zur Beschreibung digitaler Schaltungen, die von Hardware Designern für aktuelle Designs verwendet wird.

VDHL ist neben Verilog eine der weltweit am meisten genutzten Hardwarebeschreibungssprachen und hat sich in Europa zum "'Quasi-Standard"' entwickelt. Die erste Spezifikation der Sprache wurde in den frühen 1980er Jahren entwickelt und ist das Ergebnis von Normierungsbestrebungen eines Komitees, in dem die meisten größeren CAD-Anbieter und CAD-Nutzer, aber auch Vereinigungen wie die IEEE, vertreten waren. Der größte nordamerikanische Anwender, das US-Verteidigungsministerium, hat VHDL zum Durchbruch verholfen, indem es die Einhaltung der Syntax von VHDL als notwendige Voraussetzung für die Erteilung von Aufträgen gemacht hat. \cite{Ashenden}

VHDL wurde ursprünglich entwickelt aufgrund der Forderung des US-Verteidigungsministerium, das komplexe Verhalten von ASICs die Zulieferer in ihren Geräten einbauten, zu dokumentieren. So gesehen kann mann daher sagen, VHDL wurde als Alternative zu großen, komplexen Handbüchern die implementierungs-spezifische Details enthalten, entwickelt.

Der Vorteil dieser simulierbaren Dokumentation war so bestechend, dass Logik-Simulatoren entwickelt wurden, die die VHDL Dateien lesen konnte. Der nächste Schritt war die Entwicklung von Logik-Synthese Tools die basierend auf dem VHDL-Code die physische Implementierung des Schaltkreisses erzeugen konnten.

Aufgrund der Vorderung des Ministerium das soviel wie möglich der Syntax auf Ada basieren solle, um zu vermeiden dass Konzepte die schon
ausführlich getestet wurden während der Entwicklung von Ada, wieder erfunden werden mussten, übernimmt VHDL viel von der Ada Programmiersprache sowohl in Konzepten als auch Syntax.

\section{Versionen und Standards von VHDL}
Die initiale Version von VHDL wurde unter dem IEEE Standard 1076-1987 veröffentlicht, und enthielt verschiedene Datentypen, numerische (\textit{integer} und \textit{real}), logische (\textit{bit} und \textit{boolean}), \textit{character} und \textit{time}, und arrays von \textit{bit} und \textit{character} (bit\_vector string)

Danach wurde erkannt, dass sich mit den vorhanden Datentypen \textit{bit} und \textit{boolean} "'multi-valued logic"', in dem  ein Signal die Zustände (undefiniert, schwach, stark) annehmen kann, nicht modellieren lassen kann. Dieses Problem wurde mit dem IEEE 1164 Standard gelöst, der die zusätzlichen 9-wertige logische Datentypen std\_ulogic und std\_ulogic\_vector definiert.

Im Jahr 1993 wurde eine Aktualisierung des Standards veröffentlicht, der vorallem die Syntax konsistenter machte, den Zeichensatz auf ISO-8859-1 erweiterte und den XNOR Operator einführte.

Kleinere Änderungen des Standards im Jahr 2000 und 2002 fügten VHDL unter anderem die schon in Ada bekannten \textit{protected types} hinzu, mit dem sich wechselseitige Ausschlüsse definieren lassen können.

Neben dem IEEE Standard 1076, der die eigentliche Sprache definiert, gibt es zusätzlich noch verwandte die die Sprache erweitern oder Funktionalität von verschiedenen Libraries beschreibt. Der Standard 1076.2 führt Datentypen und Funktionen für die bessere Behandlung von komplexen Zahlen ein, 1076.3 führt \textit{signed} und \textit{unsigned} Datentypen ein, mit denen arithmetische Operationen auf arrays ausgeführt werden können. IEEE Standard 1076.1 (besser bekannt als VHDL-AMS) beschreibt Erweiterungen für gemischte analog und digitale Schaltungen.

Im Juni 2006 wurde durch ein technisches Komitee ein Entwurf für VHDL-2006 vorgelegt. Dieser Entwurf war vollkommen abwärtskompatibel mit älteren Versionen, fügte aber viele Erweiterungen hinzu, die das Schreiben von Code erleichtern. Die wichtigste Änderung war, dass die verwandten Standards 1164, 1076.2, 1076.3 in den 1076 Standard hinzugefügt wurden. Zusätzlich wurden neue Operatoren, flexiblere Syntax für \textit{case} und \textit{generate} Statements und ein Interface zu C/C++ hinzugefügt.

Im Jahr 2008 wurde eine neuere Version dieses Entwurf, nachdem die bisher darin entdeckten Probleme gelöst wurden, veröffentlicht. Anschließend wurde die letzte Version als IEEE 1076-2008 Standard im Januar 2009 veröffentlicht.

\section{Sprachumfang}
In VHDL wird der Source Code in Bibliotheken organisiert, wobei jede Bibliotheken jeweils compilierten
und durch den Simulator ausführbaren VHDL-Code enthalten. Bibliotheken können folgende vier Teile enthalten:
\begin{itemize}
	\item \textit{package} globale Deklarationen
	\item \textit{entity} Design Sicht von Außen (black box)
	\item \textit{architecture} Design Implementation
	\item \textit{configuration} Festlegung einer Design-Version (Zuordnung: entity architecture)
\end{itemize}

Neben herstellereigenen- und benutzerdefinierten Bibliotheken gibt es zwei Standardbibliotheken:
\begin{itemize}
	\item \textit{work} Standard-Bibliothek des Benutzers. Wenn nicht anders angegeben, dann ist WORK die Bibliothek, mit der die Programme arbeiten.
	\item \textit{std} enthält die beiden Packages \textit{standard} und \textit{TEXTIO} mit vordefinierten Datentypen und Funktionen.
\end{itemize} \cite{VHDLKompakt}

\subsection{Package}
Deklarationen die in mehreren Designs benutzt werden, z.B.: Unterprogramme(Funktionen, Prozeduren) oder Typen, Konstanten, lassen sich in Packages 
sammeln und in Bibliotheken hinterlegen. Neben eigenen Bibliotheken werden so auch die Zellbibliotheken der ASIC-Hersteller ausgeliefert. 
Auch die Hersteller von CAD-Software stellen Hilfsroutinen und Funktionen als Packages bereit, die den Umgang mit den Werkzeugen erleichtern. \cite{VHDLKompakt}

Durch verschiedene Standards werden eine Reihe von Packages definiert um den Entwickler ein Herstellerunabhängiges arbeiten zu ermöglichen:

\begin{itemize}
	\item \textit{standard} definiert elementare Datentypen wie \textit{BOOLEAN}, \textit{BIT}, \textit{CHARACTER}, \textit{INTEGER}, \textit{REAL}, \textit{TIME} und wird automatisch von alles Designs verwendet
	\item in \textit{math\_complex} wird der type \textit{COMPLEX} und Funktionen zum arbeiten mit komplexen Zahlen definiert
	\item \textit{math\_real} definiert Konstanten wie Pi und eine Reihe von trigonometrischen und logarithmischen Funktionen
	\item \textit{std\_logic\_1164} bietet wie schon in de Einleitung erwähnt die 9-wertige logische Datentypen mit der sich verschiedene Zustände eines Signals beschreiben lassen.
	\item \textit{numeric\_std} definiert die Typen \textit{SIGNED} und \textit{UNSIGNED} und zusätzlich werden die arithmetischen Operatoren für ein komfortables Arbeiten überladen
	\item \textit{textio} bietet Funktionen zum Lesen und Schreiben von Text Dateien mit dem sich z.B. stimuli Werte einlesen lassen
\end{itemize}
\lstset{caption={Auszug aus dem im IEEE Standard 1164 beschriebenen std\_logic\_1164 \textit{package}},label=reg4Entity}
\lstinputlisting{src/std_logic_1164.vhd}

\subsection{Entity}
Mit Hilfe einer \textit{entity} wird die externe Sichtweise, d.h. die Schnittstelle einer Komponente definiert. Diese Schnittstelle umfasst den Namen, die Ein- und Ausgänge und zusätzliche 
Deklarationen. Die Implementierung wird dann in einer von mehreren möglichen der \textit{entity} zugehörigen \textit{architecture} beschrieben. Eine \textit{entity} kann wiederum als 
Komponente als Teil der Hierarch in einer anderen \textit{architecture} instanziert werden.

Eine Entity-Deklaration kann zusätzlich zu den Ein- und Ausgängen (\textit{ports}) auch Parameter der Entity (\textit{generics}) festlegen. 
Mit ihnen lassen sich interne Eigenschaften und Wortbreiten einstellen. In den Architekturen entsprechen die Generics dann Konstanten. 

\lstset{caption={Beispiel für ein Entity Statement},label=reg4Entity}
\lstinputlisting{src/reg4Entity.vhd}
\begin{figure}
  \centering
    \includegraphics[scale=0.75]{images/reg4Entity.png}
    \caption{Schaltungssymbol der Reg4 Entity}
\end{figure}

\subsection{Architecture}

\lstset{caption={Beispiel für ein Architecture Statement},label=reg4Behv}
\lstinputlisting{src/reg4Behv.vhd}
\begin{figure}
  \centering
    \includegraphics[scale=0.6]{images/reg4Behv.png}
    \caption{Schaltungssymbol der Reg4 Behaviour}
\end{figure}

\lstset{caption={Beispiel für ein AND Gate},label=ANDGATE}
\lstinputlisting{src/ANDGATE.vhd}

\todo{5 Seiten}
\section{VHDL Compiler, Simulatoren und Synthesetools}
\section{Leistungsumfang des OpenVC in Bezug auf VHDL-2002}
VHDL 2002, Erweiterungen von 2008